<svg width="900" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #34495e; }
      .component { font-family: Arial, sans-serif; font-size: 11px; fill: #2c3e50; }
      .label { font-family: Arial, sans-serif; font-size: 9px; fill: #7f8c8d; }
      .security-label { font-family: Arial, sans-serif; font-size: 9px; fill: #c0392b; font-weight: bold; }
      .input-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .process-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .security-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .storage-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .output-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .security-arrow { stroke: #e74c3c; stroke-width: 2; fill: none; marker-end: url(#security-arrowhead); }
      .encrypted-flow { stroke: #27ae60; stroke-width: 3; fill: none; stroke-dasharray: 8,4; marker-end: url(#encrypted-arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
    <marker id="security-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />
    </marker>
    <marker id="encrypted-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="25" text-anchor="middle" class="title">Data Flow and Security Controls</text>
  
  <!-- Input Sources -->
  <g id="input-sources">
    <text x="50" y="70" class="subtitle">Input Sources</text>
    
    <!-- Keyboard Input -->
    <rect x="30" y="80" width="80" height="50" rx="5" class="input-box"/>
    <text x="70" y="100" text-anchor="middle" class="component">Keyboard</text>
    <text x="70" y="115" text-anchor="middle" class="label">Keystrokes</text>
    
    <!-- Mouse Input -->
    <rect x="30" y="140" width="80" height="50" rx="5" class="input-box"/>
    <text x="70" y="160" text-anchor="middle" class="component">Mouse</text>
    <text x="70" y="175" text-anchor="middle" class="label">Clicks & Movement</text>
    
    <!-- Clipboard Input -->
    <rect x="30" y="200" width="80" height="50" rx="5" class="input-box"/>
    <text x="70" y="220" text-anchor="middle" class="component">Clipboard</text>
    <text x="70" y="235" text-anchor="middle" class="label">Content</text>
    
    <!-- System Input -->
    <rect x="30" y="260" width="80" height="50" rx="5" class="input-box"/>
    <text x="70" y="280" text-anchor="middle" class="component">System</text>
    <text x="70" y="295" text-anchor="middle" class="label">Windows & USB</text>
  </g>
  
  <!-- Privacy Filtering Stage -->
  <g id="privacy-filtering">
    <text x="200" y="70" class="subtitle">Privacy Filtering</text>
    
    <!-- Sensitive Data Detection -->
    <rect x="160" y="100" width="120" height="80" rx="5" class="security-box"/>
    <text x="220" y="125" text-anchor="middle" class="component">Sensitive Data Detection</text>
    <text x="220" y="140" text-anchor="middle" class="label">• Password Fields</text>
    <text x="220" y="150" text-anchor="middle" class="label">• Credit Card Numbers</text>
    <text x="220" y="160" text-anchor="middle" class="label">• SSN Patterns</text>
    <text x="220" y="170" text-anchor="middle" class="label">• Custom Keywords</text>
    
    <!-- Application Filtering -->
    <rect x="160" y="200" width="120" height="60" rx="5" class="security-box"/>
    <text x="220" y="220" text-anchor="middle" class="component">Application Filtering</text>
    <text x="220" y="235" text-anchor="middle" class="label">• Excluded Apps</text>
    <text x="220" y="245" text-anchor="middle" class="label">• Privacy Rules</text>
    <text x="220" y="255" text-anchor="middle" class="label">• Content Limits</text>
  </g>
  
  <!-- Data Processing Stage -->
  <g id="data-processing">
    <text x="380" y="70" class="subtitle">Data Processing</text>
    
    <!-- Data Sanitization -->
    <rect x="340" y="100" width="120" height="70" rx="5" class="process-box"/>
    <text x="400" y="120" text-anchor="middle" class="component">Data Sanitization</text>
    <text x="400" y="135" text-anchor="middle" class="label">• Hash Sensitive Data</text>
    <text x="400" y="145" text-anchor="middle" class="label">• Redact Passwords</text>
    <text x="400" y="155" text-anchor="middle" class="label">• Truncate Content</text>
    <text x="400" y="165" text-anchor="middle" class="label">• Apply Privacy Rules</text>
    
    <!-- Event Aggregation -->
    <rect x="340" y="190" width="120" height="60" rx="5" class="process-box"/>
    <text x="400" y="210" text-anchor="middle" class="component">Event Aggregation</text>
    <text x="400" y="225" text-anchor="middle" class="label">• Buffer Management</text>
    <text x="400" y="235" text-anchor="middle" class="label">• Batch Processing</text>
    <text x="400" y="245" text-anchor="middle" class="label">• Metadata Addition</text>
  </g>
  
  <!-- Encryption Stage -->
  <g id="encryption">
    <text x="550" y="70" class="subtitle">Encryption Layer</text>
    
    <!-- AES Encryption -->
    <rect x="510" y="120" width="120" height="80" rx="5" class="security-box"/>
    <text x="570" y="145" text-anchor="middle" class="component">AES-256-GCM</text>
    <text x="570" y="160" text-anchor="middle" class="component">Encryption</text>
    <text x="570" y="175" text-anchor="middle" class="label">• Authenticated Encryption</text>
    <text x="570" y="185" text-anchor="middle" class="label">• Secure Key Management</text>
    <text x="570" y="195" text-anchor="middle" class="label">• Integrity Protection</text>
  </g>
  
  <!-- Storage Layer -->
  <g id="storage">
    <text x="720" y="70" class="subtitle">Secure Storage</text>
    
    <!-- Encrypted Storage -->
    <rect x="680" y="120" width="120" height="80" rx="5" class="storage-box"/>
    <text x="740" y="145" text-anchor="middle" class="component">Encrypted Log Files</text>
    <text x="740" y="160" text-anchor="middle" class="label">• Automatic Rotation</text>
    <text x="740" y="170" text-anchor="middle" class="label">• Compression</text>
    <text x="740" y="180" text-anchor="middle" class="label">• Backup Management</text>
    <text x="740" y="190" text-anchor="middle" class="label">• Access Controls</text>
  </g>
  
  <!-- Output and Analysis -->
  <g id="output">
    <text x="450" y="350" class="subtitle">Output and Analysis</text>
    
    <!-- Web Interface -->
    <rect x="200" y="380" width="120" height="80" rx="5" class="output-box"/>
    <text x="260" y="405" text-anchor="middle" class="component">Web Dashboard</text>
    <text x="260" y="420" text-anchor="middle" class="label">• Real-time Monitoring</text>
    <text x="260" y="430" text-anchor="middle" class="label">• Configuration</text>
    <text x="260" y="440" text-anchor="middle" class="label">• User Authentication</text>
    <text x="260" y="450" text-anchor="middle" class="label">• Session Management</text>
    
    <!-- Log Parser -->
    <rect x="380" y="380" width="120" height="80" rx="5" class="output-box"/>
    <text x="440" y="405" text-anchor="middle" class="component">Log Parser</text>
    <text x="440" y="420" text-anchor="middle" class="label">• Pattern Analysis</text>
    <text x="440" y="430" text-anchor="middle" class="label">• Statistics Generation</text>
    <text x="440" y="440" text-anchor="middle" class="label">• Export Formats</text>
    <text x="440" y="450" text-anchor="middle" class="label">• Report Generation</text>
    
    <!-- Export Formats -->
    <rect x="560" y="380" width="120" height="80" rx="5" class="output-box"/>
    <text x="620" y="405" text-anchor="middle" class="component">Export Options</text>
    <text x="620" y="420" text-anchor="middle" class="label">• JSON Format</text>
    <text x="620" y="430" text-anchor="middle" class="label">• CSV Format</text>
    <text x="620" y="440" text-anchor="middle" class="label">• Text Reports</text>
    <text x="620" y="450" text-anchor="middle" class="label">• Statistical Analysis</text>
  </g>
  
  <!-- Data Flow Arrows -->
  <!-- Input to Privacy Filtering -->
  <line x1="110" y1="105" x2="160" y2="140" class="arrow"/>
  <line x1="110" y1="165" x2="160" y2="140" class="arrow"/>
  <line x1="110" y1="225" x2="160" y2="140" class="arrow"/>
  <line x1="110" y1="285" x2="160" y2="230" class="arrow"/>
  
  <!-- Privacy Filtering to Processing -->
  <line x1="280" y1="140" x2="340" y2="135" class="security-arrow"/>
  <line x1="280" y1="230" x2="340" y2="220" class="security-arrow"/>
  
  <!-- Processing to Encryption -->
  <line x1="460" y1="135" x2="510" y2="160" class="arrow"/>
  <line x1="460" y1="220" x2="510" y2="160" class="arrow"/>
  
  <!-- Encryption to Storage -->
  <line x1="630" y1="160" x2="680" y2="160" class="encrypted-flow"/>
  
  <!-- Storage to Output -->
  <line x1="740" y1="200" x2="740" y2="300" class="encrypted-flow"/>
  <line x1="740" y1="300" x2="260" y2="380" class="encrypted-flow"/>
  <line x1="740" y1="300" x2="440" y2="380" class="encrypted-flow"/>
  <line x1="740" y1="300" x2="620" y2="380" class="encrypted-flow"/>
  
  <!-- Security Controls Annotations -->
  <g id="security-annotations">
    <text x="50" y="520" class="subtitle">Security Controls Applied</text>
    
    <!-- Privacy Controls -->
    <rect x="50" y="530" width="200" height="60" rx="3" fill="#ecf0f1" stroke="#bdc3c7"/>
    <text x="60" y="545" class="security-label">Privacy Controls:</text>
    <text x="60" y="560" class="label">• Sensitive data detection and filtering</text>
    <text x="60" y="570" class="label">• Application-based exclusions</text>
    <text x="60" y="580" class="label">• Content length limitations</text>
    
    <!-- Encryption Controls -->
    <rect x="270" y="530" width="200" height="60" rx="3" fill="#ecf0f1" stroke="#bdc3c7"/>
    <text x="280" y="545" class="security-label">Encryption Controls:</text>
    <text x="280" y="560" class="label">• AES-256-GCM authenticated encryption</text>
    <text x="280" y="570" class="label">• Secure key generation and storage</text>
    <text x="280" y="580" class="label">• End-to-end data protection</text>
    
    <!-- Access Controls -->
    <rect x="490" y="530" width="200" height="60" rx="3" fill="#ecf0f1" stroke="#bdc3c7"/>
    <text x="500" y="545" class="security-label">Access Controls:</text>
    <text x="500" y="560" class="label">• Web interface authentication</text>
    <text x="500" y="570" class="label">• Session management</text>
    <text x="500" y="580" class="label">• Role-based permissions</text>
  </g>
  
  <!-- Performance Optimizations -->
  <g id="performance-annotations">
    <text x="50" y="620" class="subtitle">Performance Optimizations</text>
    
    <!-- Buffering -->
    <rect x="50" y="630" width="150" height="50" rx="3" fill="#f8f9fa" stroke="#dee2e6"/>
    <text x="60" y="645" class="security-label">Buffering:</text>
    <text x="60" y="660" class="label">• Configurable buffer sizes</text>
    <text x="60" y="670" class="label">• Batch processing</text>
    
    <!-- Compression -->
    <rect x="220" y="630" width="150" height="50" rx="3" fill="#f8f9fa" stroke="#dee2e6"/>
    <text x="230" y="645" class="security-label">Compression:</text>
    <text x="230" y="660" class="label">• Log file compression</text>
    <text x="230" y="670" class="label">• Storage optimization</text>
    
    <!-- Threading -->
    <rect x="390" y="630" width="150" height="50" rx="3" fill="#f8f9fa" stroke="#dee2e6"/>
    <text x="400" y="645" class="security-label">Threading:</text>
    <text x="400" y="660" class="label">• Non-blocking operations</text>
    <text x="400" y="670" class="label">• Concurrent processing</text>
    
    <!-- Resource Management -->
    <rect x="560" y="630" width="150" height="50" rx="3" fill="#f8f9fa" stroke="#dee2e6"/>
    <text x="570" y="645" class="security-label">Resource Management:</text>
    <text x="570" y="660" class="label">• Memory monitoring</text>
    <text x="570" y="670" class="label">• Automatic cleanup</text>
  </g>
  
  <!-- Legend -->
  <g id="legend">
    <text x="750" y="520" class="subtitle">Legend</text>
    
    <line x1="750" y1="535" x2="780" y2="535" class="arrow"/>
    <text x="785" y="540" class="label">Data Flow</text>
    
    <line x1="750" y1="550" x2="780" y2="550" class="security-arrow"/>
    <text x="785" y="555" class="label">Security Control</text>
    
    <line x1="750" y1="565" x2="780" y2="565" class="encrypted-flow"/>
    <text x="785" y="570" class="label">Encrypted Data</text>
    
    <rect x="750" y="580" width="15" height="10" class="input-box"/>
    <text x="770" y="590" class="label">Input Source</text>
    
    <rect x="750" y="595" width="15" height="10" class="security-box"/>
    <text x="770" y="605" class="label">Security Layer</text>
    
    <rect x="750" y="610" width="15" height="10" class="storage-box"/>
    <text x="770" y="620" class="label">Storage Layer</text>
  </g>
</svg>